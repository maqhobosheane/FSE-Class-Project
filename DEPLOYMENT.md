# FSE Bot Deployment Guide for Render

## Prerequisites

1. **GitHub Repository**: Your code should be in a GitHub repository
2. **Render Account**: Sign up at [render.com](https://render.com)
3. **Telegram Bot Token**: Get one from [@BotFather](https://t.me/botfather)

## Environment Variables Required

You'll need to set these environment variables in Render:

### Required Variables:
- `TELEGRAM_BOT_TOKEN`: Your Telegram bot token from @BotFather
- `WEBHOOK_URL`: Will be set to `https://your-app-name.onrender.com` after deployment
- `SECRET_KEY`: Auto-generated by Render (for Flask sessions)
- `ENCRYPTION_KEY`: Auto-generated by Render (for data encryption)
- `DATABASE_URL`: Auto-configured by Render (PostgreSQL connection string)

## Deployment Steps

### 1. Prepare Your Repository
- Ensure all files are committed to your GitHub repository
- The `render.yaml` file is already configured for deployment

### 2. Deploy to Render

1. **Go to Render Dashboard**
   - Visit [dashboard.render.com](https://dashboard.render.com)
   - Click "New +" â†’ "Blueprint"

2. **Connect Repository**
   - Connect your GitHub account
   - Select your FSE bot repository
   - Render will automatically detect the `render.yaml` file

3. **Configure Environment Variables**
   - In the Render dashboard, go to your service
   - Navigate to "Environment" tab
   - Add the following variables:
     ```
     TELEGRAM_BOT_TOKEN=your_actual_bot_token_here
     ```

4. **Deploy**
   - Click "Apply" to start the deployment
   - Render will:
     - Create a PostgreSQL database
     - Build your Python application
     - Run database migrations
     - Start your web service

### 3. Set Up Webhook

After deployment completes:

1. **Get Your App URL**
   - Your app will be available at: `https://your-app-name.onrender.com`

2. **Set the Webhook**
   - Visit: `https://your-app-name.onrender.com/set_webhook`
   - This will configure Telegram to send updates to your bot

### 4. Test Your Bot

1. **Send a test message** to your bot on Telegram
2. **Check the logs** in Render dashboard to ensure everything is working
3. **Verify database** is being populated correctly

## Important Notes

- **Free Tier Limitations**: 
  - Apps sleep after 15 minutes of inactivity
  - Cold starts may take 30-60 seconds
  - Database has 1GB storage limit

- **Production Considerations**:
  - Consider upgrading to a paid plan for better performance
  - Set up monitoring and alerts
  - Regular database backups

## Troubleshooting

### Common Issues:

1. **Build Failures**:
   - Check that all dependencies are in `requirements.txt`
   - Verify Python version compatibility

2. **Database Connection Issues**:
   - Ensure `DATABASE_URL` is properly set
   - Check that database migrations ran successfully

3. **Webhook Issues**:
   - Verify `WEBHOOK_URL` is set correctly
   - Check that `/set_webhook` endpoint was called

4. **Bot Not Responding**:
   - Check Render logs for errors
   - Verify `TELEGRAM_BOT_TOKEN` is correct
   - Ensure webhook is properly configured

## Monitoring

- **Logs**: Available in Render dashboard under "Logs" tab
- **Metrics**: Monitor CPU, memory, and response times
- **Database**: Check PostgreSQL metrics in the database dashboard

## Security Notes

- Never commit sensitive data to your repository
- Use Render's environment variables for all secrets
- Regularly rotate your bot token if compromised
- Monitor for unusual activity in your bot logs
